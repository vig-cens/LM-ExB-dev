System.register(["jimu-core","jimu-arcgis","jimu-ui","jimu-theme"],(function(e,t){var a={},s={},n={},r={};return{setters:[function(e){a.AppMode=e.AppMode,a.React=e.React,a.ReactRedux=e.ReactRedux,a.WidgetState=e.WidgetState,a.appActions=e.appActions,a.classNames=e.classNames,a.css=e.css,a.getAppStore=e.getAppStore,a.hooks=e.hooks,a.jsx=e.jsx,a.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules},function(e){s.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.Button=e.Button,n.Icon=e.Icon,n.Loading=e.Loading,n.LoadingType=e.LoadingType,n.Popper=e.Popper,n.Select=e.Select,n.WidgetPlaceholder=e.WidgetPlaceholder,n.defaultMessages=e.defaultMessages,n.getFallbackPlacementsModifier=e.getFallbackPlacementsModifier},function(e){r.Global=e.Global,r.useTheme=e.useTheme}],execute:function(){e((()=>{var e={86604:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M4 17.062.5 11l15.589-9 3.5 6.062zm-2.134-5.696 13.856-8 2.5 4.33-1.299.75-1-1.732-.866.5 1 1.732-1.732 1-1-1.732-.866.5 1 1.732-1.732 1-1.5-2.598-.866.5 1.5 2.598-1.732 1-1-1.732-.866.5 1 1.732-1.732 1-1-1.732-.866.5 1 1.732-1.299.75z" clip-rule="evenodd"></path></svg>'},9044:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M6 6.5a.5.5 0 0 1 1 0v6a.5.5 0 0 1-1 0zM9.5 6a.5.5 0 0 0-.5.5v6a.5.5 0 0 0 1 0v-6a.5.5 0 0 0-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M11 0H5a1 1 0 0 0-1 1v2H.5a.5.5 0 0 0 0 1h1.6l.81 11.1a1 1 0 0 0 .995.9h8.19a1 1 0 0 0 .995-.9L13.9 4h1.6a.5.5 0 0 0 0-1H12V1a1 1 0 0 0-1-1m0 3V1H5v2zm1.895 1h-9.79l.8 11h8.19z" clip-rule="evenodd"></path></svg>'},62686:e=>{"use strict";e.exports=s},79244:e=>{"use strict";e.exports=a},1888:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=n}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.p="";var l={};return i.p=window.jimuConfig.baseUrl,(()=>{"use strict";i.r(l),i.d(l,{__set_webpack_public_path__:()=>j,default:()=>S});var e,t=i(79244),a=i(62686),s=i(14321);!function(e){e.Classic="CLASSIC",e.Toolbar="TOOLBAR"}(e||(e={}));const n=[{key:"unitsLabelMetric",value:"metric"},{key:"unitsLabelImperial",value:"imperial"}];var r=i(9044),o=i.n(r),u=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a};const c=e=>{const a=window.SVG,{className:s}=e,n=u(e,["className"]),r=(0,t.classNames)("jimu-icon jimu-icon-component",s);return a?t.React.createElement(a,Object.assign({className:r,src:o()},n)):t.React.createElement("svg",Object.assign({className:r},n))},d=[...n,{key:"unitsInches",value:"inches"},{key:"unitsLabelFeet",value:"feet"},{key:"unitsLabelYards",value:"yards"},{key:"unitsLabelMiles",value:"miles"},{key:"unitsLabelNauticalMiles",value:"nautical-miles"},{key:"unitsLabelFeetUS",value:"us-feet"},{key:"unitsLabelMeters",value:"meters"},{key:"unitsLabelKilometers",value:"kilometers"}],m=[...n,{key:"unitsLabelSquareInches",value:"square-inches"},{key:"unitsLabelSquareFeet",value:"square-feet"},{key:"unitsLabelSquareYards",value:"square-yards"},{key:"unitsLabelSquareMiles",value:"square-miles"},{key:"unitsLabelSquareFeetUS",value:"square-us-feet"},{key:"unitsLabelSquareMeters",value:"square-meters"},{key:"unitsLabelSquareKilometers",value:"square-kilometers"},{key:"unitsLabelAcres",value:"acres"},{key:"unitsLabelAres",value:"ares"},{key:"unitsLabelHectares",value:"hectares"}],v=t.css`
&.measure-toolbar {
  height: 40px;
  .measure-tools {
    height: 24px;
    .measure-tool {
      border-radius: var(--sys-shape-1) !important;
      &.active {
        color: var(--sys-color-action-selected-text);
        background-color: var(--sys-color-action-selected);
      }
    }
  }
  .measure-unit-clear {
    height: 24px;
    flex-grow: 1;
    border-left: 1px solid var(--sys-color-secondary-main);
    .measure-unit {
      flex-grow: 1;
    }
  }
}
`,p=t.React.forwardRef(((a,n)=>{const{config:r,context:i,activeButton:l,translate:o,onSelectTool:u,onChangeUnit:p,onClear:g}=a,{enableDistance:f=!0,defaultDistanceUnit:b="metric",enableArea:y=!0,defaultAreaUnit:h="metric",arrangement:x=e.Classic}=r,[w,M]=t.React.useState(b),[R,S]=t.React.useState(h);t.React.useEffect((()=>{"measureDistance"===l&&M(b),"measureArea"===l&&S(h)}),[l,h,b]);const j=t.React.useCallback((e=>{M(e.target.value),p(e.target.value)}),[p]),k=t.React.useCallback((e=>{S(e.target.value),p(e.target.value)}),[p]),A=x===e.Toolbar,C=[{name:"measureDistance",icon:`${i.folderUrl}dist/runtime/assets/measure-distance.svg`,enabled:f},{name:"measureArea",icon:`${i.folderUrl}dist/runtime/assets/measure-area.svg`,enabled:y}];return(0,t.jsx)("div",{ref:n,className:"measure-toolbar d-flex justify-content-between p-2",css:v},(0,t.jsx)("div",{className:"measure-tools d-flex"},C.filter((e=>e.enabled)).map((e=>(0,t.jsx)(s.Button,{key:e.name,icon:!0,type:"tertiary",className:(0,t.classNames)("measure-tool p-0 mr-1",{active:l===e.name}),onClick:()=>{u(e)},"aria-label":o(e.name)},(0,t.jsx)(s.Icon,{className:"m-0",icon:e.icon}))))),A&&(0,t.jsx)("div",{className:"measure-unit-clear d-flex align-items-center"},"measureDistance"===l&&f&&(0,t.jsx)(s.Select,{size:"sm",value:w,className:"measure-unit ml-1",onChange:j,"aria-label":o("defaultUnit")},d.map((e=>(0,t.jsx)("option",{key:e.key,value:e.value},o(e.key))))),"measureArea"===l&&y&&(0,t.jsx)(s.Select,{size:"sm",value:R,className:"measure-unit ml-1",onChange:k,"aria-label":o("defaultUnit")},m.map((e=>(0,t.jsx)("option",{key:e.key,value:e.value},o(e.key))))),""===l&&(0,t.jsx)(s.Select,{size:"sm",value:"measureUnit",disabled:!0,className:"measure-unit ml-1"},(0,t.jsx)("option",{value:"measureUnit"},o("measureUnit"))),(0,t.jsx)(s.Button,{icon:!0,type:"tertiary",className:"p-0 ml-1",disabled:""===l,onClick:g,"aria-label":o("clearMeasurement")},(0,t.jsx)(c,{className:"m-0"}))))}));var g=i(1888);const f=e=>{var t,a,s,n,r,i,l,o,u,c,d,m,v,p,g;return`\n  --calcite-color-text-inverse: ${null===(r=null===(n=null===(s=null===(a=null===(t=e.components)||void 0===t?void 0:t.button)||void 0===a?void 0:a.variants)||void 0===s?void 0:s.primary)||void 0===n?void 0:n.default)||void 0===r?void 0:r.color} !important;\n  --calcite-color-brand: ${null===(c=null===(u=null===(o=null===(l=null===(i=e.components)||void 0===i?void 0:i.button)||void 0===l?void 0:l.variants)||void 0===o?void 0:o.primary)||void 0===u?void 0:u.default)||void 0===c?void 0:c.bg} !important;\n  --calcite-color-brand-hover: ${null===(g=null===(p=null===(v=null===(m=null===(d=e.components)||void 0===d?void 0:d.button)||void 0===m?void 0:m.variants)||void 0===v?void 0:v.primary)||void 0===p?void 0:p.hover)||void 0===g?void 0:g.bg} !important;\n`},b=(e,a)=>t.css`
&.measure-panel {
  border-top: 1px solid var(--sys-color-divider-primary);
  overflow: auto;
  .measure-clear {
    padding: 0 15px 12px 15px;
    button {
      width: 100%;
      height: 32px;
    }
  }
  .esri-widget {
    background-color: transparent !important;
  }
  ${f(e)}
  ${["disabled","ready"].includes(a)?t.css`
    height: calc(100% - 42px);
    .esri-widget--panel {
      height: 100%;
      .esri-measurement-widget-content {
        height: 100%;
        .esri-measurement-widget-content__hint {
          height: 100%;
          display: grid;
          place-items: center;
          text-align: center;
        }
      }
    }`:""}
}
`,y=[(0,s.getFallbackPlacementsModifier)(["top-start"]),{name:"preventOverflow",enabled:!0,options:{boundariesElement:"viewport",padding:0}}];function h(a){const{id:n,config:r,activeButton:i,jimuMapView:l,activeTool:o,setActiveTool:u,rootRef:c,translate:d,onClear:m}=a,{defaultDistanceUnit:v="metric",defaultAreaUnit:p="metric",arrangement:h=e.Classic}=r,[x,w]=t.React.useState(!1),[M,R]=t.React.useState(null);t.React.useEffect((()=>{w(!0),(0,t.loadArcGISJSAPIModules)(["esri/widgets/DistanceMeasurement2D","esri/widgets/AreaMeasurement2D","esri/widgets/DirectLineMeasurement3D","esri/widgets/AreaMeasurement3D","esri/core/reactiveUtils"]).then((e=>{const[t,a,s,n,r]=e;R({DistanceMeasurement2D:t,AreaMeasurement2D:a,DirectLineMeasurement3D:s,AreaMeasurement3D:n,reactiveUtils:r}),w(!1)}))}),[]);const S=t.React.useRef(null),j=t.React.useRef(null),k=t.React.useRef({}),A=t.React.useRef(null);t.React.useEffect((()=>{Object.values(k.current).forEach((e=>{e.measureDistance&&(e.measureDistance.viewModel.unit=v),e.measureArea&&(e.measureArea.viewModel.unit=p)}))}),[v,p]);const C=h===e.Toolbar,L=C?j:S,[D,N]=t.React.useState("disabled"),I=t.hooks.useLatest(l);t.React.useEffect((()=>{var e,t,a,s;const r=I.current;if(!(null==r?void 0:r.view)||!L.current||!M)return;const l=o;"object"==typeof(null==l?void 0:l.container)&&null!==(null==l?void 0:l.container)&&(l.container.style.visibility="hidden",l.container.style.height="0",l.container.style.overflow="hidden");const d=null===(e=null==l?void 0:l.viewModel)||void 0===e?void 0:e.state;let m,g;["ready","measuring"].includes(d)&&l.viewModel.clear(),A.current&&(null===(a=null===(t=A.current)||void 0===t?void 0:t.remove)||void 0===a||a.call(t),A.current=null);const{DistanceMeasurement2D:f,AreaMeasurement2D:b,DirectLineMeasurement3D:y,AreaMeasurement3D:h,reactiveUtils:x}=M,w=k.current[r.id]||(k.current[r.id]={});if("measureDistance"===i)m="2d"===r.view.type?f:y,g=v;else{if("measureArea"!==i)return void N("disabled");m="2d"===r.view.type?b:h,g=p}w[i]||m&&g&&(w[i]=new m({id:`${n}-${r.id}-${i}`,container:document.createElement("div"),view:r.view,unit:g,visible:!0}));const R=w[i];u(R),"object"==typeof(null==R?void 0:R.container)&&null!==(null==R?void 0:R.container)&&(R.container.style.visibility="visible",R.container.style.height="",R.container.style.overflow="");const S=null===(s=null==R?void 0:R.viewModel)||void 0===s?void 0:s.state;N(S||"disabled"),"measured"!==S&&R&&R.viewModel.start(),R&&(L.current.prepend(R.container),A.current=x.watch((()=>{var e;return null===(e=null==R?void 0:R.viewModel)||void 0===e?void 0:e.state}),(e=>{N(e||"disabled")}))),c.current&&j.current&&(j.current.style.width=c.current.offsetWidth+"px")}),[n,i,I,L,o,u,c,v,p,M]);const T=t.React.useMemo((()=>{var e;return null===(e=null==l?void 0:l.isClickHighlightEnabled)||void 0===e?void 0:e.call(l)}),[l]);t.React.useEffect((()=>{T&&(["ready","measuring"].includes(D)?l.disableClickHighlight():l.enableClickHighlight())}),[l,D,T]);const O=t.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===t.AppMode.Design)),U=t.ReactRedux.useSelector((e=>e.appRuntimeInfo.currentPageId)),_=U!==t.React.useRef(U).current,P=t.React.useCallback((()=>{Object.values(k.current).forEach((e=>{var t,a,s,n;null===(a=null===(t=e.measureDistance)||void 0===t?void 0:t.destroy)||void 0===a||a.call(t),e.measureDistance=null,null===(n=null===(s=e.measureArea)||void 0===s?void 0:s.destroy)||void 0===n||n.call(s),e.measureArea=null}))}),[]),E=t.ReactRedux.useSelector((e=>e.appContext.isInBuilder));t.hooks.useUpdateEffect((()=>{E&&(P(),N("disabled"))}),[l,h,E]),t.React.useEffect((()=>()=>{P(),u(null)}),[P,u]);const q=(0,g.useTheme)();return(0,t.jsx)(t.React.Fragment,null,x&&(0,t.jsx)(s.Loading,{type:s.LoadingType.Secondary}),!x&&!C&&(0,t.jsx)("div",{ref:S,className:"measure-panel",css:b(q,D)},""===i&&(0,t.jsx)("div",{"aria-label":d("selectToStart"),className:"esri-widget esri-widget--panel",role:"presentation"},(0,t.jsx)("div",{className:"esri-measurement-widget-content"},(0,t.jsx)("section",{className:"esri-measurement-widget-content__hint"},(0,t.jsx)("p",{className:"esri-measurement-widget-content__hint-text"},d("selectToStart"))))),""!==i&&["measuring","measured"].includes(D)&&(0,t.jsx)("div",{className:"measure-clear"},(0,t.jsx)(s.Button,{type:"secondary",onClick:m,"aria-label":d("clearMeasurement")},d("clearMeasurement")))),!x&&C&&!O&&(0,t.jsx)(s.Popper,{className:(0,t.classNames)("surface-1",{"d-none":_}),reference:c.current,placement:"bottom-start",open:""!==i,keepMount:!0,modifiers:y,offset:[0,5]},(0,t.jsx)("div",{ref:j,className:"measure-popper"}),(0,t.jsx)(g.Global,{styles:t.css`
        .measure-popper {
          .esri-widget {
            background-color: transparent !important;
          }
          .esri-measurement-widget-content__settings {
            display: ${C?"none":"block"};
          }
          ${f(q)}
        }
      `})))}const x={_widgetLabel:"Measurement",selectToStart:"Select a tool to start measure.",measureDistance:"Measure distance",measureArea:"Measure area",clearMeasurement:"Clear measurement",measureUnit:"Measure unit"};var w=i(86604),M=i.n(w);const R=t.css`
  min-width: 270px;
  min-height: 40px;
  height: 100%;
  overflow: auto;
`;function S(n){const{id:r,useMapWidgetIds:i,context:l,config:o}=n,{enableDistance:u=!0,enableArea:c=!0,arrangement:d=e.Classic}=o,m=null==i?void 0:i[0],[v,g]=t.React.useState(null),[f,b]=t.React.useState(!0),y=t.React.useCallback((()=>{b(!1)}),[]),[w,S]=t.React.useState(""),j=t.ReactRedux.useSelector((e=>e.appRuntimeInfo.appMode===t.AppMode.Design)),k=t.ReactRedux.useSelector((e=>e.widgetsRuntimeInfo[r].state===t.WidgetState.Closed));t.React.useEffect((()=>{S("")}),[j,u,c,d,k,i,v]);const A=t.ReactRedux.useSelector((e=>{var t;return(null===(t=e.mapWidgetsInfo[m])||void 0===t?void 0:t.autoControlWidgetId)===r}));t.React.useEffect((()=>{A||S("")}),[A]);const C=t.React.useRef(null),[L,D]=t.React.useState(null),N=t.React.useCallback((e=>{L&&(L.unit=e)}),[L]),I=t.React.useCallback((()=>{L&&L.viewModel.clear()}),[L]),T=m&&(u||c),O=t.hooks.useTranslation(s.defaultMessages,x);return(0,t.jsx)("div",{id:r,className:"widget-measurement h-100 surface-1 border-0",css:R},!T&&(0,t.jsx)("div",{className:"w-100 h-100"},(0,t.jsx)(s.WidgetPlaceholder,{className:"w-100 placeholder-wrapper",icon:M(),widgetId:n.id,message:O("_widgetLabel")})),T&&(0,t.jsx)(t.React.Fragment,null,(0,t.jsx)("div",{className:(0,t.classNames)("h-100",{"d-none":f})},(0,t.jsx)(p,{ref:C,config:o,context:l,activeButton:w,activeTool:L,translate:O,onSelectTool:e=>{if(e.name===w){S("");const e=t.appActions.releaseAutoControlMapWidget(m);(0,t.getAppStore)().dispatch(e)}else{S(e.name);const a=t.appActions.requestAutoControlMapWidget(m,r);(0,t.getAppStore)().dispatch(a)}},onChangeUnit:N,onClear:I}),(0,t.jsx)(h,{id:r,config:o,jimuMapView:v,activeButton:w,activeTool:L,setActiveTool:D,rootRef:C,translate:O,onClear:I})),(0,t.jsx)(a.JimuMapViewComponent,{useMapWidgetId:m,onViewsCreate:y,onActiveViewChange:g}),m&&f&&(0,t.jsx)(s.Loading,{type:s.LoadingType.Secondary})))}function j(e){i.p=e}})(),l})())}}}));