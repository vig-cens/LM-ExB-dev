System.register([],(function(e,o){return{execute:function(){e((()=>{"use strict";var e={d:(o,t)=>{for(var i in t)e.o(t,i)&&!e.o(o,i)&&Object.defineProperty(o,i,{enumerable:!0,get:t[i]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{default:()=>c});var t,i,n,u,a,r;!function(e){e.GeocodeService="GeocodeService",e.FeatureService="FeatureService"}(t||(t={})),function(e){e.ResultPanel="Result_Panel",e.OtherWidgets="Other_Widgets"}(i||(i={})),function(e){e.Style1="Style1",e.Style2="Style2",e.Style3="Style3"}(n||(n={})),function(e){e.Classic="Classic",e.Compact="Compact"}(u||(u={})),function(e){e.None="",e.Init="init",e.Loading="loading",e.Loaded="loaded",e.Warning="warning",e.Error="error"}(a||(a={})),function(e){e.CustomSearchSources="CustomSearchSources",e.MapCentric="MapCentric"}(r||(r={}));class c{constructor(){this.id="search-app-config-operation"}afterWidgetCopied(e,o,i,n,u){var a,r,c,v;const f=(null===(r=null===(a=o.widgets[e])||void 0===a?void 0:a.outputDataSources)||void 0===r?void 0:r.asMutable({deep:!0}))||[],S=(null===(v=null===(c=o.widgets[i])||void 0===c?void 0:c.outputDataSources)||void 0===v?void 0:v.asMutable({deep:!0}))||[];if(0===(null==f?void 0:f.length))return n;let g=n;const p=n.widgets[i].config,D=(null==p?void 0:p.datasourceConfig).map((e=>{if(e.searchServiceType===t.FeatureService)return e;{const o=e.outputDataSourceId,t=l(f,S,o);return e=e.set("outputDataSourceId",t)}}));g=g.setIn(["widgets",i,"config","datasourceConfig"],D);const I=null==n?void 0:n.messageConfigs;if(I){const e={};Object.keys(I).forEach((o=>{const t=I[o];if((null==t?void 0:t.widgetId)===i&&(null==t?void 0:t.actions)){const i=t.actions.map((e=>{var o,t,i,n,u,a;if(null==e?void 0:e.useDataSources){const o=e.useDataSources,t=s(f,S,o);e=e.set("useDataSources",t)}const r=null===(o=null==e?void 0:e.config)||void 0===o?void 0:o.messageUseDataSource;if(r&&f.includes(null==r?void 0:r.dataSourceId)){const o=d(f,S,r);e=e.setIn(["config","messageUseDataSource"],o)}if((null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.useDataSource)&&f.includes(null===(n=null===(i=null==e?void 0:e.config)||void 0===i?void 0:i.useDataSource)||void 0===n?void 0:n.dataSourceId)){const o=null===(u=null==e?void 0:e.config)||void 0===u?void 0:u.useDataSource,t=d(f,S,o);e=e.setIn(["config","useDataSource"],t)}if(null===(a=null==e?void 0:e.config)||void 0===a?void 0:a.useDataSources){const o=s(f,S,null==e?void 0:e.config.useDataSources);e=e.setIn(["config","useDataSources"],o)}return e}));e[o]=t.set("actions",i)}else e[o]=t})),g=g.set("messageConfigs",e)}return g}useDataSourceWillRemove(e,o){var t;let i=e.widgets[this.widgetId],n=i.config;const u=null===(t=i.useDataSources.filter((e=>e.dataSourceId===o||e.rootDataSourceId===o)))||void 0===t?void 0:t.map((e=>e.dataSourceId)),a=i.useDataSources.filter((e=>e.dataSourceId!==o||e.rootDataSourceId!==o));if(u&&(null==u?void 0:u.length)>0){if(n.sourceType===r.MapCentric){const e=n.dataSourceConfigWithMapCentric,t={};Object.keys(e).forEach((i=>{var n;const a=null===(n=e[i])||void 0===n?void 0:n.asMutable({deep:!0});if(!1===(null==a?void 0:a.synchronizeSettings)&&(null==a?void 0:a.dataSourceConfig)){const e=null==a?void 0:a.dataSourceConfig.filter((e=>{var o;return!u.includes(null===(o=null==e?void 0:e.useDataSource)||void 0===o?void 0:o.dataSourceId)}));a.dataSourceConfig=e}i.split("-")[1]!==o&&(t[i]=a)})),n=n.set("dataSourceConfigWithMapCentric",t)}else{const e=n.datasourceConfig.filter((e=>{var o;return!u.includes(null===(o=null==e?void 0:e.useDataSource)||void 0===o?void 0:o.dataSourceId)}));n=n.set("datasourceConfig",e)}i=i.set("useDataSources",a).set("config",n),e=e.setIn(["widgets",this.widgetId],i)}return e}}function s(e,o,t){return t.map((t=>d(e,o,t)))}function d(e,o,t){if(e.includes(null==t?void 0:t.dataSourceId)){const i=l(e,o,t.dataSourceId);return t.set("dataSourceId",i).set("mainDataSourceId",i)}return t}function l(e,o,t){const i=e.indexOf(t);return i>-1?o[i]:t}return o})())}}}));